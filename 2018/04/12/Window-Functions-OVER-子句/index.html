<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Window Functions ���ں���"><meta name="keywords" content="SQL"><meta name="author" content="Black_Jack,undefined"><meta name="copyright" content="Black_Jack"><title>Window Functions ���ں��� | 穷不忘道,老而能学</title><link rel="shortcut icon" href="/blog/favicon.ico"><link rel="stylesheet" href="/blog/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.3"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/blog/',
  algolia: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  localSearch: undefined
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#OVER�Ӿ�"><span class="toc-number">1.</span> <span class="toc-text">OVER�Ӿ�</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#�ۺϺ���"><span class="toc-number">1.1.</span> <span class="toc-text">�ۺϺ���</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#��������"><span class="toc-number">1.2.</span> <span class="toc-text">��������</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#�ֲ�����"><span class="toc-number">1.3.</span> <span class="toc-text">�ֲ�����</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ƫ�ƺ���"><span class="toc-number">1.4.</span> <span class="toc-text">ƫ�ƺ���</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#���ں���ʵ�ֻ�������"><span class="toc-number">2.</span> <span class="toc-text">���ں���ʵ�ֻ�������</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#��ҳ"><span class="toc-number">2.1.</span> <span class="toc-text">��ҳ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#z��"><span class="toc-number">2.2.</span> <span class="toc-text">ȥ��</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#����y��jn������"><span class="toc-number">2.3.</span> <span class="toc-text">����ÿ��ǰn������</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#�����ۻ��ϼ�"><span class="toc-number">2.4.</span> <span class="toc-text">�����ۻ��ϼ�</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ͳ����󲢷�"><span class="toc-number">2.5.</span> <span class="toc-text">ͳ����󲢷�</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gap-amp-island"><span class="toc-number">2.6.</span> <span class="toc-text">gap&amp;island</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#����ֲ���gʽ"><span class="toc-number">2.7.</span> <span class="toc-text">����ֲ���ģʽ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#�����νu"><span class="toc-number">2.8.</span> <span class="toc-text">�����νṹ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#����͸��"><span class="toc-number">2.9.</span> <span class="toc-text">����͸��</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#����ʱЧ��"><span class="toc-number">2.10.</span> <span class="toc-text">����ʱЧ��</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#���ں����Z�"><span class="toc-number">3.</span> <span class="toc-text">���ں����Ż�</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#���ڴ��ں����L������"><span class="toc-number">4.</span> <span class="toc-text">���ڴ��ں����Ľ������</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#��������Դ"><span class="toc-number">5.</span> <span class="toc-text">��������Դ</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/blog/img/avatar.png"></div><div class="author-info__name text-center">Black_Jack</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/blog/archives"><span class="pull-left">Articles</span><span class="pull-right">7</span></a><a class="author-info-articles__tags article-meta" href="/blog/tags"><span class="pull-left">Tags</span><span class="pull-right">5</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container" style="background-image: url(true)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/blog/">穷不忘道,老而能学</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">Window Functions ���ں���</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-04-12</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div id="post-content"><blockquote>
<ol>
<li><a href="#OVER�Ӿ�" title="OVER�Ӿ�">OVER�Ӿ�</a><ol>
<li><a href="#�ۺϺ���" title="�ۺϺ���">�ۺϺ���</a></li>
<li><a href="#��������" title="��������">��������</a></li>
<li><a href="#ƫ�ƺ���" title="ƫ�ƺ���">ƫ�ƺ���</a></li>
</ol>
</li>
<li><a href="#���ں���ʵ�ֻ�������" title="���ں���ʵ�ֻ�������">���ں���ʵ�ֻ�������</a><ol>
<li><a href="#��ҳ" title="��ҳ">��ҳ</a></li>
<li><a href="#ȥ��" title="ȥ��">ȥ��</a></li>
<li><a href="#����ÿ��ǰn������" title="����ÿ��ǰn������">����ÿ��ǰn������</a></li>
<li><a href="#�����ۻ��ϼ�" title="�����ۻ��ϼ�">�����ۻ��ϼ�</a></li>
<li><a href="#ͳ����󲢷�" title="ͳ����󲢷�">ͳ����󲢷�</a></li>
<li><a href="#gap&amp;island" title="gap&amp;island">gap&amp;island</a></li>
<li><a href="#����ֲ���ģʽ" title="����ֲ���ģʽ">����ֲ���ģʽ</a></li>
<li><a href="#�����νṹ" title="�����νṹ">�����νṹ</a></li>
<li><a href="#����͸��" title="����͸��">����͸��</a></li>
<li><a href="#����ʱЧ��" title="����ʱЧ��">����ʱЧ��</a></li>
</ol>
</li>
<li><a href="#���ں����Ż�" title="���ں����Ż�">���ں����Ż�</a></li>
<li><a href="#���ڴ��ں����Ľ������" title="���ڴ��ں����Ľ������">���ڴ��ں����Ľ������</a></li>
<li><a href="#��������Դ" title="��������Դ">��������Դ</a></li>
</ol>
</blockquote>
<h2 id="OVER�Ӿ�"><a href="#OVER�Ӿ�" class="headerlink" title="OVER�Ӿ�"></a>OVER�Ӿ�</h2><ul>
<li>�����˴��������ǵ��뵱ǰ����ص������м����е������������Ԫ��</li>
<li>��׼ȷ��˵,���ݴ��ں�����Ϊ��������ڲ�ѯ�߼������׶ε�λ�ã����ں���������һ�������м���һ����ϵ</li>
</ul>
<p>�������£�<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> orderid,orderdate,val,<span class="keyword">RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> val <span class="keyword">DESC</span>) <span class="keyword">AS</span> rnk</span><br><span class="line"><span class="keyword">FROM</span> Sales.OrderValues</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> rnk</span><br></pre></td></tr></table></figure></p>
<h3 id="�ۺϺ���"><a href="#�ۺϺ���" class="headerlink" title="�ۺϺ���"></a>�ۺϺ���</h3><ul>
<li>SUM</li>
<li>COUNT</li>
<li>MIN</li>
<li>MAX<br>SQLSERVER 2005 ��ʼ֧��</li>
</ul>
<h3 id="��������"><a href="#��������" class="headerlink" title="��������"></a>��������</h3><ul>
<li>RANK</li>
<li>DENSE_RANK</li>
<li>ROW_NUMBER</li>
<li>NTILE<br>SQLSERVER 2005 ��ʼ֧��</li>
</ul>
<h3 id="�ֲ�����"><a href="#�ֲ�����" class="headerlink" title="�ֲ�����"></a>�ֲ�����</h3><ul>
<li>PERCENT_RANK</li>
<li>CUME_DIST</li>
<li>PERCENT_CONT</li>
<li>PERCENTILE_DISC<br>SQLSERVER 2012 ��ʼ֧��</li>
</ul>
<h3 id="ƫ�ƺ���"><a href="#ƫ�ƺ���" class="headerlink" title="ƫ�ƺ���"></a>ƫ�ƺ���</h3><ul>
<li>LAG</li>
<li>LEAD</li>
<li>FIRST_VALUE</li>
<li>LAST_VALUE<br>�����ĸ�����SQL SERVER2012��ʼ֧��</li>
<li>NTH_VALUE</li>
</ul>
<h2 id="���ں���ʵ�ֻ�������"><a href="#���ں���ʵ�ֻ�������" class="headerlink" title="���ں���ʵ�ֻ�������"></a>���ں���ʵ�ֻ�������</h2><h3 id="��ҳ"><a href="#��ҳ" class="headerlink" title="��ҳ"></a>��ҳ</h3><h3 id="z��"><a href="#z��" class="headerlink" title="ȥ��"></a>ȥ��</h3><h3 id="����y��jn������"><a href="#����y��jn������" class="headerlink" title="����ÿ��ǰn������"></a>����ÿ��ǰn������</h3><h3 id="�����ۻ��ϼ�"><a href="#�����ۻ��ϼ�" class="headerlink" title="�����ۻ��ϼ�"></a>�����ۻ��ϼ�</h3><h3 id="ͳ����󲢷�"><a href="#ͳ����󲢷�" class="headerlink" title="ͳ����󲢷�"></a>ͳ����󲢷�</h3><h3 id="gap-amp-island"><a href="#gap-amp-island" class="headerlink" title="gap&amp;island"></a>gap&amp;island</h3><h3 id="����ֲ���gʽ"><a href="#����ֲ���gʽ" class="headerlink" title="����ֲ���ģʽ"></a>����ֲ���ģʽ</h3><h3 id="�����νu"><a href="#�����νu" class="headerlink" title="�����νṹ"></a>�����νṹ</h3><h3 id="����͸��"><a href="#����͸��" class="headerlink" title="����͸��"></a>����͸��</h3><h3 id="����ʱЧ��"><a href="#����ʱЧ��" class="headerlink" title="����ʱЧ��"></a>����ʱЧ��</h3><h2 id="���ں����Z�"><a href="#���ں����Z�" class="headerlink" title="���ں����Ż�"></a>���ں����Ż�</h2><h2 id="���ڴ��ں����L������"><a href="#���ڴ��ں����L������" class="headerlink" title="���ڴ��ں����Ľ������"></a>���ڴ��ں����Ľ������</h2><h2 id="��������Դ"><a href="#��������Դ" class="headerlink" title="��������Դ"></a>��������Դ</h2></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Black_Jack</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://foryl.github.io/blog/2018/04/12/Window-Functions-OVER-子句/">https://foryl.github.io/blog/2018/04/12/Window-Functions-OVER-子句/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/blog/tags/SQL/">SQL</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/blog/2018/04/12/常用SQL命令/"><i class="fa fa-chevron-left">  </i><span>常用SQL语句</span></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2019 By Black_Jack</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/blog/js/third-party/anime.min.js"></script><script src="/blog/js/third-party/jquery.min.js"></script><script src="/blog/js/third-party/jquery.fancybox.min.js"></script><script src="/blog/js/third-party/velocity.min.js"></script><script src="/blog/js/third-party/velocity.ui.min.js"></script><script src="/blog/js/utils.js?version=1.5.3"></script><script src="/blog/js/fancybox.js?version=1.5.3"></script><script src="/blog/js/sidebar.js?version=1.5.3"></script><script src="/blog/js/copy.js?version=1.5.3"></script><script src="/blog/js/fireworks.js?version=1.5.3"></script><script src="/blog/js/transition.js?version=1.5.3"></script><script src="/blog/js/scroll.js?version=1.5.3"></script><script src="/blog/js/head.js?version=1.5.3"></script></body></html>